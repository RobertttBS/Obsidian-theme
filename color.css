/* ===============================================================
   1. è‡ªå®šç¾©è‰²ç¥¨ (User Color Palette) - åˆ†ç‚ºæ·ºè‰²/æ·±è‰²
   =============================================================== */

/* --- â˜€ï¸ æ·ºè‰²æ¨¡å¼ï¼šæ±çª¯ç‚ºé«”ï¼Œé’èŠ±ç‚ºç”¨ --- */
.theme-light {
  /* === åŸºåº• === */
  --user-bg-white:        #F2F7F7;
  --user-bg-pink-pale:    #E6F0F0;
  --user-bg-pink-soft:    #DEEBEB;
  --user-bg-pink-deep:    #D1E3E3;
  --user-bg-blockquote:   #F0F5F5;

  /* === æ–‡å­—èˆ‡ç²—é«” === */
  --user-text-main:       #2c3e50;
  --user-text-muted:      #5D7290;
  --user-text-faint:      #8FA4C4;
  /* ç²—é«”ï¼šä½¿ç”¨æ·±é‚ƒçš„æ™®é­¯å£«è— */
  --user-text-bold:       #1A2F45; 

  /* === æ¨™é¡Œæ¼¸å±¤ (é’èŠ±æ¿ƒæ·¡) === */
  --h1-gradient:          #1C4E80; /* æ¿ƒè±”è˜‡éº»é›¢é’ */
  --h2-gradient:          #346c9c; /* ä¸­èª¿é’èŠ± */
  --h3-gradient:          #5D8AA8; /* æ·ºèª¿è—ç° */

  /* === å¼·èª¿èˆ‡é€£çµ === */
  --user-accent-main:     #346c9c;
  --user-accent-strong:   #B22222; /* é‡‰è£¡ç´… (åƒ…ç”¨æ–¼å¼·èª¿/è­¦ç¤º) */
  --user-accent-highlight:#FAEBD7;

  --user-link-internal:   #1C4E80;
  --user-link-external:   #4A90E2;

  /* === ä»‹é¢ === */
  --user-border-light:    #B0C4C4;
  --user-selection:       rgba(255, 213, 0, 0.4);

  /* === Callout å°ˆç”¨è‰²ç³» === */
  --user-accent-tip:      #74bfbb;
  --user-accent-success:  #6B8E23;
  --user-accent-warning:  #D4AF37; /* ä¿ç•™åŸæœ¬çš„é‡‘é»ƒè‰²çµ¦æ–‡å­— highlighter ç”¨ */
  --user-accent-info:     #6A5ACD;
  --user-accent-error:    #B22222;
  --user-accent-quote:    #929292;
  --user-accent-example:  #53789E;
  --user-accent-background: #9B59B6;

  --user-theme-pop:       #E0806C;

  --shadow-layer-1: rgba(0, 0, 0, 0.08);
  --shadow-layer-2: rgba(0, 0, 0, 0.04);

  /* --- 3D æµ®å‹•é™°å½± (æ±çª¯æº«æ½¤æ„Ÿ) --- */
  --float-highlight: inset 0 1.5px 0 0 rgba(255, 255, 255, 0.7);
  --float-lowlight: inset 0 -1px 0 0 rgba(0, 0, 0, 0.05);
  --float-shadow-1: 0 1px 2px rgba(0, 0, 0, 0.06); 
  --float-shadow-2: 0 3px 6px -2px rgba(28, 78, 128, 0.15);

  /* HSL è½‰æ›çµæœï¼šè‰²ç›¸ 0 (ç´…), é£½å’Œåº¦ 68%, äº®åº¦ 42% */
  --accent-h: 0;
  --accent-s: 68%;
  --accent-l: 42%;
  
  /* é‡æ–°å®£å‘Šä»¥ç¢ºä¿ç”Ÿæ•ˆ */
  --interactive-accent: hsl(var(--accent-h), var(--accent-s), var(--accent-l));
  --interactive-accent-hover: hsl(var(--accent-h), var(--accent-s), calc(var(--accent-l) + 5%));
}

/* --- ğŸŒ™ æ·±è‰²æ¨¡å¼ï¼šé’èŠ±ç‚ºæµ·ï¼Œæ±ç“·ç‚ºæ˜Ÿ --- */
.theme-dark {
  /* === åŸºåº• === */
  --user-bg-white:        #0F1626;
  --user-bg-pink-pale:    #162138;
  --user-bg-pink-soft:    #1C2945;
  --user-bg-pink-deep:    #253555;
  --user-bg-blockquote:   #152033;

  /* === æ–‡å­— === */
  --user-text-main:       #F0F8FF;
  --user-text-muted:      #8CA6A6;
  --user-text-faint:      #5F7A7A;
  --user-text-bold:       #DCD0B3; /* æµæ²™é‡‘ */

  /* === æ¨™é¡Œæ¼¸å±¤ === */
  --h1-gradient:          #8CD1D1;
  --h2-gradient:          #63B0B0;
  --h3-gradient:          #469898;

  /* === å¼·èª¿èˆ‡é€£çµ === */
  --user-accent-main:     #7CC5C5;
  --user-accent-strong:   #8A0908;
  --user-accent-highlight:#2F4F4F;

  --user-link-internal:   #A2D99E;
  --user-link-external:   #6495ED;

  /* === ä»‹é¢ === */
  --user-border-light:    #3A5F5F;
  --user-selection:       rgba(255, 213, 0, 0.4);

  /* === Callout å°ˆç”¨è‰²ç³» (æ–°å¢/æ·±è‰²é©é…) === */
  --user-accent-tip:      #48C9B0;
  --user-accent-success:  #66CDAA;
  --user-accent-warning:  #FFD700;
  --user-accent-info:     #9370DB;
  --user-accent-error:    #f32f2f;
  --user-accent-quote:    #d2d0d0;
  --user-accent-example:  #3f569f;
  --user-accent-background: #AF7AC5;

  --user-theme-pop:       #FF9E8B;

  --shadow-layer-1: rgba(130, 209, 209, 0.15);
  --shadow-layer-2: rgba(0, 0, 0, 0.5);

  --float-highlight: inset 0 1px 0 0 rgba(255, 255, 255, 0.2);
  --float-lowlight: inset 0 -1px 0 0 rgba(0, 0, 0, 0.2);
  --float-shadow-1: 0 1px 2px rgba(0, 0, 0, 0.4); 
  --float-shadow-2: 0 4px 8px -2px rgba(0, 0, 0, 0.5);

  /* HSL è½‰æ›çµæœï¼šè‰²ç›¸ 359 (ç´…), é£½å’Œåº¦ 89%, äº®åº¦ 29% */
  --accent-h: 359;
  --accent-s: 89%;
  --accent-l: 29%; 

  /* âš ï¸ æ³¨æ„ï¼šäº®åº¦ 29% åœ¨æ·±è‰²èƒŒæ™¯ä¸‹å¯èƒ½ç•¥é¡¯é»¯æ·¡
     å¦‚æœä¸å¤ æ˜é¡¯ï¼Œå¯ä»¥è©¦è‘—æŠŠä¸Šé¢çš„ --accent-l æ”¹æˆ 40% æˆ– 50% */

  /* é‡æ–°å®£å‘Šä»¥ç¢ºä¿ç”Ÿæ•ˆ */
  --interactive-accent: hsl(var(--accent-h), var(--accent-s), var(--accent-l));
  --interactive-accent-hover: hsl(var(--accent-h), var(--accent-s), calc(var(--accent-l) + 5%));
}

/* ===============================================================
   2. æ ¸å¿ƒç³»çµ±è®Šæ•¸å°æ‡‰ (System Mappings)
   =============================================================== */
body {
  /* --- æ¨™é¡Œé¡è‰² --- */
  --h1-color: var(--h1-gradient);
  --h2-color: var(--h2-gradient);
  --h3-color: var(--h3-gradient);
  --h4-color: var(--user-text-muted);
  --h5-color: var(--user-text-muted);
  --h6-color: var(--user-text-faint);

  /* --- é€£çµèˆ‡èƒŒæ™¯ --- */
  --link-color:           var(--user-link-internal);
  --link-external-color:  var(--user-link-external);
  --background-primary:       var(--user-bg-white);
  --background-primary-alt:   var(--user-bg-pink-pale); 
  --background-secondary:     var(--user-bg-pink-soft);
  --background-secondary-alt: var(--user-bg-pink-deep);

  /* --- ä»‹é¢ --- */
  --titlebar-background:          var(--user-bg-pink-soft);
  --titlebar-background-focused:  var(--user-bg-pink-soft);
  --ribbon-background:            var(--user-bg-pink-soft);
  --ribbon-background-collapsed:  var(--user-bg-pink-soft);
  --tab-container-background:     var(--user-bg-pink-soft);

  --scrollbar-bg: transparent;
  --scrollbar-thumb-bg: var(--user-accent-main);

  /* --- æ–‡å­— --- */
  --text-normal: var(--user-text-main);
  --text-muted:  var(--user-text-muted);
  --text-faint:  var(--user-text-faint);

  /* --- äº’å‹• --- */
  --text-selection:           var(--user-selection) !important;
  --text-highlight-bg:        var(--user-accent-highlight);

  /* --- é‚Šæ¡† --- */
  --background-modifier-border:       var(--user-border-light);
  --background-modifier-border-hover: var(--user-accent-main);

  /* --- ç•¶å‰ç·¨è¼¯è¡Œ --- */
  .markdown-source-view.mod-cm6 .cm-line.cm-active {
    background-color: var(--user-bg-pink-deep) !important;
    border-radius: 4px;
  }
}

/* =================================================================
   3. å…ƒç´ æ¨£å¼è¦†è“‹ (Element Overrides)
   ================================================================= */

/* ç²—é«”å­— (Bold) */
strong, b, .cm-strong {
  color: var(--user-text-bold) !important;
  font-weight: 600;
}

/* æ¨™é¡Œ (Headers) */
.markdown-preview-view h1, 
.cm-header-1 {
  border-bottom: 1px solid var(--user-accent-strong); 
  margin-bottom: 0.8em;
}

/* åˆ—è¡¨ (Lists) */
.list-bullet:after,
.cm-formatting-list-ul {
  color: var(--user-accent-main) !important;
}
.cm-formatting-list-ol {
  color: var(--user-accent-main) !important;
}
ol > li::marker {
  color: var(--user-accent-main) !important;
  font-weight: bold;
}

/* é€£çµæ‡¸åœ */
a:hover, .internal-link:hover, .external-link:hover, .cm-link:hover, .cm-url:hover {
  background-color: var(--user-bg-pink-pale);
  text-decoration: none;
}

/* å¼•ç”¨å€å¡Š (Blockquote) */
blockquote {
  background-color: var(--user-bg-blockquote);
  color: var(--user-text-muted);
  border-color: var(--user-accent-main) !important; 
  box-shadow: 0 4px 6px -1px var(--shadow-layer-1),
              0 2px 4px -2px var(--shadow-layer-2);
}

/* Tags & Marks */
.tag, .cm-hashtag {
  background-color: var(--user-accent-highlight) !important;
  color: var(--user-text-main) !important;
}
mark {
  background-color: var(--user-accent-highlight);
  color: var(--user-text-main);
}

/* Checkbox */
input[type="checkbox"] {
  border-color: var(--user-accent-main);
  appearance: none; 
  -webkit-appearance: none;
  border-width: 1px;
  border-style: solid;
  border-radius: 4px;
}
input[type="checkbox"]:checked {
  background-position: center;
  background-repeat: no-repeat;
  box-shadow: inset 0 0 2px var(--user-bg-white);
}

/* ===============================================================
   4. ç¨‹å¼ç¢¼èˆ‡è¡¨æ ¼
   =============================================================== */
.markdown-preview-view pre code,
.cm-s-obsidian pre.HyperMD-codeblock {
  background-color: var(--user-bg-pink-pale) !important;
  color: var(--user-text-main) !important;
  border: 1px solid var(--user-bg-pink-deep);
}

.markdown-preview-view table {
  border-color: var(--user-border-light);
}
.markdown-preview-view table thead tr > th {
  background-color: var(--user-bg-pink-deep);
  color: var(--user-text-main);
  border-bottom-color: var(--user-accent-main);
}
.markdown-preview-view table tbody tr:nth-child(even) {
  background-color: var(--user-bg-pink-pale);
}

/* ===============================================================
   5. ä»‹é¢å¾®èª¿ & Scrollbar
   =============================================================== */
.nav-file-title.is-active {
  background-color: var(--user-bg-pink-deep);
  color: var(--user-accent-main);
  border-left: 4px solid var(--user-theme-pop);
  border-radius: 0 4px 4px 0;
}
.nav-file-title:hover {
  background-color: var(--user-bg-pink-pale);
  box-shadow: inset 4px 0 0 0 var(--user-accent-strong);
}
.collapse-icon {
  color: var(--user-theme-pop) !important;
}

/* Scrollbar */
::-webkit-scrollbar {
  width: 10px;
  height: 6px;
  background-color: transparent;
}
::-webkit-scrollbar-thumb {
  background-color: var(--user-accent-strong) !important;
  border-radius: 6px;
  border: 2px solid transparent;
  background-clip: content-box;
}
::-webkit-scrollbar-track {
  background-color: transparent;
}
::-webkit-scrollbar-thumb:hover {
  background-color: var(--user-accent-main);
}

/* ===============================================================
   6. Graph View
   =============================================================== */
.theme-dark .graph-view.color-fill,
.theme-light .graph-view.color-fill { color: var(--user-text-muted); }
.graph-view.color-circle { color: var(--user-accent-main); }
.graph-view.color-line { color: var(--user-border-light); }
.graph-view.color-text { color: var(--user-text-main); }

/* ===============================================================
   7. Callout é€šç”¨è¨­å®š (3D å¯¦é«”æ„Ÿ)
   =============================================================== */
.callout {
	  word-break: break-word;     /* è®“é•·å–®å­—åœ¨é‚Šç•Œè™•æ–·è¡Œ */
    overflow-wrap: anywhere;    /* å¼·åˆ¶é•·ç¶²å€æˆ–ç„¡ç©ºç™½å­—ä¸²åœ¨ä»»ä½•åœ°æ–¹æ–·è¡Œ */
    white-space: normal;        /* ç¢ºä¿æ–‡å­—æ­£å¸¸æ›è¡Œ */
    max-width: 100%;            /* ç¢ºä¿å¯¬åº¦ä¸è¶…éçˆ¶å®¹å™¨ */
    box-sizing: border-box;     /* ç¢ºä¿ Padding ä¸æœƒå°è‡´å¯¬åº¦è¨ˆç®—éŒ¯èª¤ */

    overflow: visible !important;
    margin: 0.6em 2px !important;
    border: none !important; 
    border-radius: 10px !important; 
    
    /* å…‰å½±å †ç–Šï¼šé«˜å…‰ + å…§ç¸®åº•å½± + è²¼åœ°å½± + æ“´æ•£å½± */
    box-shadow: 
        var(--float-highlight),
        var(--float-lowlight), 
        var(--float-shadow-1), 
        var(--float-shadow-2) !important;

    transition: transform 0.15s ease, box-shadow 0.15s ease;
}

/* æ·ºè‰²æ¨¡å¼ï¼šé‡‰é¢æ„Ÿæ¼¸å±¤ */
.theme-light .callout {
    background-image: linear-gradient(180deg, rgba(255,255,255,0.3) 0%, rgba(255,255,255,0) 100%);
    border: 1px solid rgba(255,255,255, 0.4) !important;
}

/* æ·±è‰²æ¨¡å¼ï¼šå¾®å¼±å…‰æ„Ÿ */
.theme-dark .callout {
    background-image: linear-gradient(180deg, rgba(255,255,255,0.02) 0%, rgba(0,0,0,0.1) 100%);
    border: 1px solid rgba(255,255,255, 0.05) !important;
}

/* æ‡¸åœæ•ˆæœ */
.callout:hover {
    transform: translateY(-1px);
    box-shadow: 
        var(--float-highlight),
        var(--float-lowlight),
        0 2px 4px rgba(0,0,0,0.1),
        0 6px 12px -2px rgba(0,0,0,0.15) !important;
}

/* å…§éƒ¨ Padding */
.callout-title { padding: 10px 14px 6px 14px; }
.callout-content { padding: 0 14px 14px 14px; }

/* ===============================================================
   8. Callout é¡è‰²å…¨é¢æ˜ å°„ (Color Mappings)
   =============================================================== */

/* --- ğŸ”¹ é’è‰² (Cyan) ---
   Group: Abstract
   Aliases: summary, tldr
   Group: Tip
   Aliases: hint, important
*/
.callout:is([data-callout="abstract"], [data-callout="summary"], [data-callout="tldr"], [data-callout="tip"], [data-callout="hint"], [data-callout="important"]) {
    --callout-color: var(--user-accent-tip);
    --callout-icon: "lucide-lightbulb"; /* é è¨­åœ–ç¤ºï¼Œå¯è¢« Obsidian å…§å»ºè¦†è“‹ */
    background-color: color-mix(in srgb, var(--user-accent-tip) 25%, transparent) !important;
}

/* Group: Note, Info, Todo */
.callout:is([data-callout="note"], [data-callout="info"], [data-callout="todo"]) {
    --callout-color: var(--user-accent-info);
    background-color: color-mix(in srgb, var(--user-accent-info) 25%, transparent) !important;
}

/* Group: Success, Aliases: check, done */
.callout:is([data-callout="success"], [data-callout="check"], [data-callout="done"]) {
    --callout-color: var(--user-accent-success);
    background-color: color-mix(in srgb, var(--user-accent-success) 25%, transparent) !important;
}

/*
   Group: Question (help, faq)
   Group: Warning (caution, attention)
*/
.callout:is([data-callout="question"], [data-callout="help"], [data-callout="faq"], [data-callout="warning"], [data-callout="caution"], [data-callout="attention"]) {
    --callout-color: var(--user-accent-warning);
    background-color: color-mix(in srgb, var(--user-accent-warning) 25%, transparent) !important;
}

/*
   Group: Failure (fail, missing)
   Group: Danger (error, bug)
*/
.callout:is([data-callout="failure"], [data-callout="fail"], [data-callout="missing"], [data-callout="danger"], [data-callout="error"], [data-callout="bug"]) {
    --callout-color: var(--user-accent-error);
    background-color: color-mix(in srgb, var(--user-accent-error) 25%, transparent) !important;
}

/*
   Group: Quote
   Aliases: cite
*/
.callout:is([data-callout="quote"], [data-callout="cite"]) {
    --callout-color: var(--user-accent-background);
    background-color: color-mix(in srgb, var(--user-accent-quote) 25%, transparent) !important;
}

.callout:is([data-callout="example"], [data-callout="e.g."]) {
    --callout-color: var(--user-accent-example);
    background-color: color-mix(in srgb, var(--user-accent-example) 25%, transparent) !important;
}

.callout[data-callout="quote"] .callout-content {
    font-family: serif; /* å¢åŠ æ›¸å·æ°£ */
}

/* ===============================================================
   9. å…¶ä»–ç´°ç¯€ (Misc)
   =============================================================== */
.cm-hashtag-begin { color: var(--user-accent-strong) !important; font-weight: bold; }
.cm-hashtag-end { color: var(--user-text-main) !important; }
.workspace-tab-header.is-active { box-shadow: inset 0 2px 0 0 var(--user-accent-strong); }
.cm-footref, .cm-formatting-link, .external-link-icon { color: var(--user-accent-strong) !important; }

/* æ°´å¹³ç·š (Horizontal Rule) */
.markdown-preview-view hr,
hr {
  border: none;
  height: 1px;
  background-color: var(--user-accent-strong);
  opacity: 1;
}